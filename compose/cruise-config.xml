<?xml version="1.0" encoding="utf-8"?>
<cruise xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="cruise-config.xsd" schemaVersion="104">
  <server artifactsdir="artifacts" agentAutoRegisterKey="123456789abcdefgh987654321" webhookSecret="57b5b4a5-e839-4735-935c-168e97b80033" commandRepositoryLocation="default" serverId="239404b7-69fe-4fc9-81e9-945654461562" tokenGenerationKey="fddbb9b3-1a53-4f1e-986b-4c3547bb79ba" />
  <config-repos>
    <config-repo pluginId="json.config.plugin" id="repo1">
      <git url="https://github.com/ccsalway/gocd-config.git" />
    </config-repo>
  </config-repos>
  <pipelines group="MyPythonApp" />
  <pipelines group="CyrmTools">
    <pipeline name="Common">
      <materials>
        <git url="git+ssh://leeeroooy@bitbucket.org/naimuri/cyrm_common.git" />
      </materials>
      <stage name="defaultStage">
        <jobs>
          <job name="defaultJob">
            <tasks>
              <exec command="sh">
                <arg>sed -i "s/DEVELOPMENT_BUILD/$BUILD_NUMBER/" setup.py</arg>
                <arg>cd build</arg>
                <arg>chmod +x build-docker.sh</arg>
                <arg>./build-docker.sh $BBUSER $BBPASS</arg>
              </exec>
            </tasks>
          </job>
        </jobs>
      </stage>
    </pipeline>
  </pipelines>
  <templates>
    <pipeline name="SetupAndRunPython">
      <stage name="SetupAndRunStage" cleanWorkingDir="true">
        <jobs>
          <job name="SetupAndRunJob">
            <tasks>
              <exec command="python">
                <arg>setup.py</arg>
                <arg>install</arg>
                <arg>--user</arg>
              </exec>
              <exec command="python">
                <arg>main.py</arg>
                <runif status="passed" />
              </exec>
            </tasks>
          </job>
        </jobs>
      </stage>
    </pipeline>
  </templates>
  <agents>
    <agent hostname="9395ed43952a" ipaddress="172.18.0.3" uuid="331ef78e-9680-478b-ab3c-58fe3deb48bc" />
    <agent hostname="e6c5e8b0bd48" ipaddress="172.18.0.4" uuid="c63cd9ef-b0dd-49ec-b437-15e92db3916d" />
    <agent hostname="7846428f93da" ipaddress="172.18.0.4" uuid="fe8726b3-98fa-48f4-bec5-375813c050dd" />
    <agent hostname="ab54dac0fc87" ipaddress="172.18.0.3" uuid="d615ee5a-b45c-4482-83f3-0484af3b545a" />
    <agent hostname="28bd4c330745" ipaddress="172.18.0.4" uuid="613757bc-7bd4-4684-aeba-98e927a06426" />
    <agent hostname="8d972f9eb59a" ipaddress="172.18.0.3" uuid="a0935159-4fdc-402f-992e-aaff659e9530" />
  </agents>
</cruise>
